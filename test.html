<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StreamWatch æµ‹è¯•é¡µé¢ / Test Page</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: #2a2a2a;
            border-radius: 8px;
            border-left: 4px solid #00ff88;
        }
        .video-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        video, audio {
            width: 100%;
            max-width: 100%;
            background: #000;
            border-radius: 5px;
        }
        .controls {
            margin: 10px 0;
        }
        button {
            background: #00ff88;
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
        }
        button:hover {
            background: #00cc6a;
        }
        .info {
            background: #333;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
        }
        .warning {
            background: #ff6b35;
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .code {
            background: #1e1e1e;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            border: 1px solid #555;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ¬ StreamWatch æµ‹è¯•é¡µé¢</h1>
        <p>StreamWatch Test Page - ç”¨äºæµ‹è¯•æµåª’ä½“ç›‘æ§è„šæœ¬</p>
        <p><strong>ç‰ˆæœ¬:</strong> 1.0.0-2025 | <strong>ä½œè€…:</strong> MissChina</p>
    </div>

    <div class="test-section">
        <h2>ğŸ“– ä½¿ç”¨è¯´æ˜ / Instructions</h2>
        <div class="warning">
            <strong>âš ï¸ é‡è¦æé†’:</strong> æœ¬é¡µé¢ä»…ç”¨äºæµ‹è¯• StreamWatch è„šæœ¬åŠŸèƒ½ã€‚è¯·ç¡®ä¿å·²å®‰è£… Tampermonkey æ‰©å±•æˆ–å‡†å¤‡å¥½æ§åˆ¶å°è„šæœ¬ã€‚
        </div>
        
        <h3>æ–¹æ³•ä¸€ï¼šTampermonkey ç”¨æˆ·è„šæœ¬</h3>
        <ol>
            <li>å®‰è£… Tampermonkey æµè§ˆå™¨æ‰©å±•</li>
            <li>å®‰è£… <code>streamwatch-userscript.js</code> è„šæœ¬</li>
            <li>åˆ·æ–°æ­¤é¡µé¢ï¼Œåº”è¯¥çœ‹åˆ°å³ä¸Šè§’çš„ç›‘æ§é¢æ¿</li>
            <li>ç‚¹å‡»"å¯åŠ¨ç›‘æ§"å¼€å§‹æµ‹è¯•</li>
        </ol>

        <h3>æ–¹æ³•äºŒï¼šæ§åˆ¶å°è„šæœ¬</h3>
        <ol>
            <li>æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·</li>
            <li>åˆ‡æ¢åˆ° Console æ ‡ç­¾</li>
            <li>å¤åˆ¶å¹¶ç²˜è´´ <code>streamwatch-console.js</code> çš„å†…å®¹</li>
            <li>æ‰§è¡Œè„šæœ¬åè¾“å…¥ <code>sw.start()</code> å¼€å§‹ç›‘æ§</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>ğŸ¥ æµ‹è¯•è§†é¢‘ / Test Videos</h2>
        <div class="video-container">
            <div>
                <h3>MP4 è§†é¢‘æµ‹è¯•</h3>
                <video id="video1" controls>
                    <source src="https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4" type="video/mp4">
                    <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
                    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾
                </video>
                <div class="controls">
                    <button onclick="loadVideo1()">åŠ è½½è§†é¢‘1</button>
                    <button onclick="playVideo1()">æ’­æ”¾</button>
                    <button onclick="pauseVideo1()">æš‚åœ</button>
                </div>
            </div>

            <div>
                <h3>WebM è§†é¢‘æµ‹è¯•</h3>
                <video id="video2" controls>
                    <source src="https://sample-videos.com/zip/10/webm/SampleVideo_1280x720_1mb.webm" type="video/webm">
                    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾
                </video>
                <div class="controls">
                    <button onclick="loadVideo2()">åŠ è½½è§†é¢‘2</button>
                    <button onclick="changeSource()">åˆ‡æ¢æº</button>
                </div>
            </div>
        </div>

        <div>
            <h3>ğŸµ éŸ³é¢‘æµ‹è¯• / Audio Test</h3>
            <audio id="audio1" controls>
                <source src="https://sample-videos.com/zip/10/mp3/SampleAudio_0.4mb.mp3" type="audio/mpeg">
                <source src="https://www.soundjay.com/misc/sounds/bell-ringing-05.wav" type="audio/wav">
                æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾
            </audio>
            <div class="controls">
                <button onclick="loadAudio()">åŠ è½½éŸ³é¢‘</button>
                <button onclick="playAudio()">æ’­æ”¾éŸ³é¢‘</button>
            </div>
        </div>
    </div>

    <div class="test-section">
        <h2>ğŸŒ ç½‘ç»œè¯·æ±‚æµ‹è¯• / Network Request Test</h2>
        <div class="controls">
            <button onclick="testFetch()">æµ‹è¯• Fetch è¯·æ±‚</button>
            <button onclick="testXHR()">æµ‹è¯• XHR è¯·æ±‚</button>
            <button onclick="testStreamingUrls()">æµ‹è¯•æµåª’ä½“URL</button>
            <button onclick="simulateError()">æ¨¡æ‹Ÿé”™è¯¯</button>
        </div>
        
        <div class="info">
            <strong>æµ‹è¯•é¡¹ç›®:</strong>
            <ul>
                <li>fetch() è¯·æ±‚æ‹¦æˆª</li>
                <li>XMLHttpRequest æ‹¦æˆª</li>
                <li>HLS (.m3u8) æ£€æµ‹</li>
                <li>DASH (.mpd) æ£€æµ‹</li>
                <li>åª’ä½“æ ¼å¼è¯†åˆ«</li>
                <li>é”™è¯¯å¤„ç†</li>
            </ul>
        </div>
    </div>

    <div class="test-section">
        <h2>ğŸ“Š æ§åˆ¶å°å‘½ä»¤æµ‹è¯• / Console Commands Test</h2>
        <div class="code">
// åŸºæœ¬å‘½ä»¤æµ‹è¯•
sw.help()           // æ˜¾ç¤ºå¸®åŠ©
sw.start()          // å¼€å§‹ç›‘æ§
sw.status()         // æŸ¥çœ‹çŠ¶æ€
sw.stats()          // æŸ¥çœ‹ç»Ÿè®¡

// é«˜çº§å‘½ä»¤æµ‹è¯•  
sw.monitor('video') // ç›‘æ§è§†é¢‘å…ƒç´ 
sw.search('mp4')    // æœç´¢MP4
sw.analyze('test.m3u8') // åˆ†æURL
sw.export()         // å¯¼å‡ºæ•°æ®
        </div>
    </div>

    <div class="test-section">
        <h2>ğŸ“ æµ‹è¯•æ—¥å¿— / Test Log</h2>
        <div id="testLog" class="info">
            <strong>æµ‹è¯•æ—¥å¿—å°†åœ¨è¿™é‡Œæ˜¾ç¤º...</strong>
        </div>
    </div>

    <script>
        // æµ‹è¯•æ—¥å¿—å‡½æ•°
        function log(message) {
            const logElement = document.getElementById('testLog');
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `<br>[${timestamp}] ${message}`;
            console.log(`[TestPage] ${message}`);
        }

        // è§†é¢‘æ§åˆ¶å‡½æ•°
        function loadVideo1() {
            const video = document.getElementById('video1');
            video.load();
            log('ğŸ¥ åŠ è½½è§†é¢‘1');
        }

        function playVideo1() {
            const video = document.getElementById('video1');
            video.play().then(() => {
                log('â–¶ï¸ è§†é¢‘1å¼€å§‹æ’­æ”¾');
            }).catch(err => {
                log('âŒ æ’­æ”¾å¤±è´¥: ' + err.message);
            });
        }

        function pauseVideo1() {
            const video = document.getElementById('video1');
            video.pause();
            log('â¸ï¸ è§†é¢‘1æš‚åœ');
        }

        function loadVideo2() {
            const video = document.getElementById('video2');
            video.load();
            log('ğŸ¥ åŠ è½½è§†é¢‘2');
        }

        function changeSource() {
            const video = document.getElementById('video2');
            const sources = [
                'https://sample-videos.com/zip/10/webm/SampleVideo_1280x720_1mb.webm',
                'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.webm'
            ];
            const randomSource = sources[Math.floor(Math.random() * sources.length)];
            video.src = randomSource;
            log('ğŸ”„ åˆ‡æ¢è§†é¢‘æº: ' + randomSource);
        }

        function loadAudio() {
            const audio = document.getElementById('audio1');
            audio.load();
            log('ğŸµ åŠ è½½éŸ³é¢‘');
        }

        function playAudio() {
            const audio = document.getElementById('audio1');
            audio.play().then(() => {
                log('ğŸµ éŸ³é¢‘å¼€å§‹æ’­æ”¾');
            }).catch(err => {
                log('âŒ éŸ³é¢‘æ’­æ”¾å¤±è´¥: ' + err.message);
            });
        }

        // ç½‘ç»œè¯·æ±‚æµ‹è¯•
        function testFetch() {
            const testUrls = [
                'https://example.com/video.mp4',
                'https://example.com/stream.m3u8',
                'https://example.com/manifest.mpd'
            ];
            
            testUrls.forEach(url => {
                fetch(url).catch(() => {}); // å¿½ç•¥é”™è¯¯ï¼Œåªæµ‹è¯•æ‹¦æˆª
                log('ğŸŒ Fetchè¯·æ±‚: ' + url);
            });
        }

        function testXHR() {
            const testUrls = [
                'https://example.com/audio.mp3',
                'https://example.com/live/stream.m3u8',
                'https://example.com/video/manifest.mpd'
            ];
            
            testUrls.forEach(url => {
                const xhr = new XMLHttpRequest();
                xhr.open('GET', url);
                xhr.send();
                log('ğŸ“¡ XHRè¯·æ±‚: ' + url);
            });
        }

        function testStreamingUrls() {
            const streamingUrls = [
                'https://example.com/hls/playlist.m3u8',
                'https://example.com/dash/manifest.mpd',
                'https://example.com/rtmp/live/stream',
                'https://example.com/videos/sample.mp4',
                'https://example.com/audio/track.aac'
            ];
            
            streamingUrls.forEach(url => {
                // æ¨¡æ‹Ÿæ£€æµ‹
                log('ğŸ” æ£€æµ‹æµåª’ä½“URL: ' + url);
                
                // å¦‚æœ StreamWatch å·²åŠ è½½ï¼Œä½¿ç”¨å…¶åˆ†æåŠŸèƒ½
                if (window.sw && window.sw.analyze) {
                    window.sw.analyze(url);
                }
            });
        }

        function simulateError() {
            const video = document.getElementById('video1');
            video.src = 'https://nonexistent.example.com/error.mp4';
            video.load();
            log('âŒ æ¨¡æ‹Ÿè§†é¢‘åŠ è½½é”™è¯¯');
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('ğŸ“„ æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            log('ğŸ¬ StreamWatch v1.0.0-2025 æµ‹è¯•ç¯å¢ƒå°±ç»ª');
            
            // æ£€æŸ¥æ˜¯å¦å·²åŠ è½½ StreamWatch
            setTimeout(() => {
                if (window.streamWatch) {
                    log('âœ… æ£€æµ‹åˆ° Tampermonkey ç‰ˆæœ¬çš„ StreamWatch');
                } else if (window.sw) {
                    log('âœ… æ£€æµ‹åˆ°æ§åˆ¶å°ç‰ˆæœ¬çš„ StreamWatch');
                } else {
                    log('âš ï¸ æœªæ£€æµ‹åˆ° StreamWatchï¼Œè¯·ç¡®ä¿è„šæœ¬å·²æ­£ç¡®åŠ è½½');
                }
            }, 1000);
        });

        // ç›‘å¬åª’ä½“äº‹ä»¶ç”¨äºæµ‹è¯•
        document.addEventListener('loadstart', (e) => {
            if (e.target.tagName === 'VIDEO' || e.target.tagName === 'AUDIO') {
                log(`ğŸ“¥ ${e.target.tagName} å¼€å§‹åŠ è½½: ${e.target.currentSrc || e.target.src}`);
            }
        }, true);

        document.addEventListener('error', (e) => {
            if (e.target.tagName === 'VIDEO' || e.target.tagName === 'AUDIO') {
                log(`âŒ ${e.target.tagName} åŠ è½½é”™è¯¯`);
            }
        }, true);

        document.addEventListener('canplay', (e) => {
            if (e.target.tagName === 'VIDEO' || e.target.tagName === 'AUDIO') {
                log(`âœ… ${e.target.tagName} å¯ä»¥æ’­æ”¾`);
            }
        }, true);
    </script>
</body>
</html>